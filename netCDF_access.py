import xarray as xr
#code to access PT params from PT_all_grid.nc
# Load the NetCDF file
ds = xr.open_dataset('PT_all_grid.nc')
registred_pixel = ['(-33.75, -7.704221481600492)', '(-35.15625, -6.303454035707604)', '(-35.15625, -7.704221481600492)', '(-36.5625, -10.505756145243598)', '(-36.5625, -6.303454035707604)', '(-36.5625, -7.704221481600492)', '(-36.5625, -9.104988856048523)', '(-37.96875, -10.505756145243598)', '(-37.96875, -11.906523334953757)', '(-37.96875, -4.902686531826539)', '(-37.96875, -6.303454035707604)', '(-37.96875, -7.704221481600492)', '(-37.96875, -9.104988856048523)', '(-39.375, -10.505756145243598)', '(-39.375, -11.906523334953757)', '(-39.375, -13.307290410446194)', '(-39.375, -14.708057356404804)', '(-39.375, -16.108824156841283)', '(-39.375, -17.509590794998555)', '(-39.375, -3.501918983131298)', '(-39.375, -4.902686531826539)', '(-39.375, -6.303454035707604)', '(-39.375, -7.704221481600492)', '(-39.375, -9.104988856048523)', '(-40.78125, -10.505756145243598)', '(-40.78125, -11.906523334953757)', '(-40.78125, -13.307290410446194)', '(-40.78125, -14.708057356404804)', '(-40.78125, -16.108824156841283)', '(-40.78125, -17.509590794998555)', '(-40.78125, -18.91035725324536)', '(-40.78125, -20.311123512960364)', '(-40.78125, -4.902686531826539)', '(-40.78125, -6.303454035707604)', '(-40.78125, -7.704221481600492)', '(-40.78125, -9.104988856048523)', '(-42.1875, -10.505756145243598)', '(-42.1875, -11.906523334953757)', '(-42.1875, -13.307290410446194)', '(-42.1875, -14.708057356404804)', '(-42.1875, -16.108824156841283)', '(-42.1875, -17.509590794998555)', '(-42.1875, -18.91035725324536)', '(-42.1875, -20.311123512960364)', '(-42.1875, -21.711889554404237)', '(-42.1875, -3.501918983131298)', '(-42.1875, -4.902686531826539)', '(-42.1875, -6.303454035707604)', '(-42.1875, -7.704221481600492)', '(-42.1875, -9.104988856048523)', '(-43.59375, -10.505756145243598)', '(-43.59375, -11.906523334953757)', '(-43.59375, -13.307290410446194)', '(-43.59375, -14.708057356404804)', '(-43.59375, -16.108824156841283)', '(-43.59375, -17.509590794998555)', '(-43.59375, -18.91035725324536)', '(-43.59375, -20.311123512960364)', '(-43.59375, -21.711889554404237)', '(-43.59375, -3.501918983131298)', '(-43.59375, -4.902686531826539)', '(-43.59375, -6.303454035707604)', '(-43.59375, -7.704221481600492)', '(-43.59375, -9.104988856048523)', '(-45.0, -10.505756145243598)', '(-45.0, -11.906523334953757)', '(-45.0, -13.307290410446194)', '(-45.0, -14.708057356404804)', '(-45.0, -16.108824156841283)', '(-45.0, -17.509590794998555)', '(-45.0, -18.91035725324536)', '(-45.0, -2.1011514025789793)', '(-45.0, -20.311123512960364)', '(-45.0, -21.711889554404237)', '(-45.0, -23.112655356577648)', '(-45.0, -3.501918983131298)', '(-45.0, -4.902686531826539)', '(-45.0, -6.303454035707604)', '(-45.0, -7.704221481600492)', '(-45.0, -9.104988856048523)', '(-46.40625, -10.505756145243598)', '(-46.40625, -11.906523334953757)', '(-46.40625, -13.307290410446194)', '(-46.40625, -14.708057356404804)', '(-46.40625, -16.108824156841283)', '(-46.40625, -17.509590794998555)', '(-46.40625, -18.91035725324536)', '(-46.40625, -2.1011514025789793)', '(-46.40625, -20.311123512960364)', '(-46.40625, -21.711889554404237)', '(-46.40625, -23.112655356577648)', '(-46.40625, -3.501918983131298)', '(-46.40625, -4.902686531826539)', '(-46.40625, -6.303454035707604)', '(-46.40625, -7.704221481600492)', '(-46.40625, -9.104988856048523)', '(-47.8125, -0.7003838029733238)', '(-47.8125, -10.505756145243598)', '(-47.8125, -11.906523334953757)', '(-47.8125, -13.307290410446194)', '(-47.8125, -14.708057356404804)', '(-47.8125, -16.108824156841283)', '(-47.8125, -17.509590794998555)', '(-47.8125, -18.91035725324536)', '(-47.8125, -2.1011514025789793)', '(-47.8125, -20.311123512960364)', '(-47.8125, -21.711889554404237)', '(-47.8125, -23.112655356577648)', '(-47.8125, -24.513420897062915)', '(-47.8125, -3.501918983131298)', '(-47.8125, -4.902686531826539)', '(-47.8125, -6.303454035707604)', '(-47.8125, -7.704221481600492)', '(-47.8125, -9.104988856048523)', '(-49.21875, -0.7003838029733238)', '(-49.21875, -10.505756145243598)', '(-49.21875, -11.906523334953757)', '(-49.21875, -13.307290410446194)', '(-49.21875, -14.708057356404804)', '(-49.21875, -16.108824156841283)', '(-49.21875, -17.509590794998555)', '(-49.21875, -18.91035725324536)', '(-49.21875, -2.1011514025789793)', '(-49.21875, -20.311123512960364)', '(-49.21875, -21.711889554404237)', '(-49.21875, -23.112655356577648)', '(-49.21875, -24.513420897062915)', '(-49.21875, -25.914186151846668)', '(-49.21875, -27.314951095120396)', '(-49.21875, -28.715715699055192)', '(-49.21875, -3.501918983131298)', '(-49.21875, -4.902686531826539)', '(-49.21875, -6.303454035707604)', '(-49.21875, -7.704221481600492)', '(-49.21875, -9.104988856048523)', '(-50.625, -0.7003838029733238)', '(-50.625, -10.505756145243598)', '(-50.625, -11.906523334953757)', '(-50.625, -13.307290410446194)', '(-50.625, -14.708057356404804)', '(-50.625, -16.108824156841283)', '(-50.625, -17.509590794998555)', '(-50.625, -18.91035725324536)', '(-50.625, -2.1011514025789793)', '(-50.625, -20.311123512960364)', '(-50.625, -21.711889554404237)', '(-50.625, -23.112655356577648)', '(-50.625, -24.513420897062915)', '(-50.625, -25.914186151846668)', '(-50.625, -27.314951095120396)', '(-50.625, -28.715715699055192)', '(-50.625, -3.501918983131298)', '(-50.625, -30.116479933546326)', '(-50.625, -4.902686531826539)', '(-50.625, -6.303454035707604)', '(-50.625, -7.704221481600492)', '(-50.625, -9.104988856048523)', '(-50.625, 0.7003838029733238)', '(-52.03125, -0.7003838029733238)', '(-52.03125, -10.505756145243598)', '(-52.03125, -11.906523334953757)', '(-52.03125, -13.307290410446194)', '(-52.03125, -14.708057356404804)', '(-52.03125, -16.108824156841283)', '(-52.03125, -17.509590794998555)', '(-52.03125, -18.91035725324536)', '(-52.03125, -2.1011514025789793)', '(-52.03125, -20.311123512960364)', '(-52.03125, -21.711889554404237)', '(-52.03125, -23.112655356577648)', '(-52.03125, -24.513420897062915)', '(-52.03125, -25.914186151846668)', '(-52.03125, -27.314951095120396)', '(-52.03125, -28.715715699055192)', '(-52.03125, -3.501918983131298)', '(-52.03125, -30.116479933546326)', '(-52.03125, -31.517243765922586)', '(-52.03125, -4.902686531826539)', '(-52.03125, -6.303454035707604)', '(-52.03125, -7.704221481600492)', '(-52.03125, -9.104988856048523)', '(-52.03125, 0.7003838029733238)', '(-52.03125, 2.1011514025789793)', '(-53.4375, -0.7003838029733238)', '(-53.4375, -10.505756145243598)', '(-53.4375, -11.906523334953757)', '(-53.4375, -13.307290410446194)', '(-53.4375, -14.708057356404804)', '(-53.4375, -16.108824156841283)', '(-53.4375, -17.509590794998555)', '(-53.4375, -18.91035725324536)', '(-53.4375, -2.1011514025789793)', '(-53.4375, -20.311123512960364)', '(-53.4375, -21.711889554404237)', '(-53.4375, -23.112655356577648)', '(-53.4375, -24.513420897062915)', '(-53.4375, -25.914186151846668)', '(-53.4375, -27.314951095120396)', '(-53.4375, -28.715715699055192)', '(-53.4375, -3.501918983131298)', '(-53.4375, -30.116479933546326)', '(-53.4375, -31.517243765922586)', '(-53.4375, -4.902686531826539)', '(-53.4375, -6.303454035707604)', '(-53.4375, -7.704221481600492)', '(-53.4375, -9.104988856048523)', '(-53.4375, 0.7003838029733238)', '(-53.4375, 2.1011514025789793)', '(-54.84375, -0.7003838029733238)', '(-54.84375, -10.505756145243598)', '(-54.84375, -11.906523334953757)', '(-54.84375, -13.307290410446194)', '(-54.84375, -14.708057356404804)', '(-54.84375, -16.108824156841283)', '(-54.84375, -17.509590794998555)', '(-54.84375, -18.91035725324536)', '(-54.84375, -2.1011514025789793)', '(-54.84375, -20.311123512960364)', '(-54.84375, -21.711889554404237)', '(-54.84375, -23.112655356577648)', '(-54.84375, -28.715715699055192)', '(-54.84375, -3.501918983131298)', '(-54.84375, -30.116479933546326)', '(-54.84375, -4.902686531826539)', '(-54.84375, -6.303454035707604)', '(-54.84375, -7.704221481600492)', '(-54.84375, -9.104988856048523)', '(-54.84375, 0.7003838029733238)', '(-54.84375, 2.1011514025789793)', '(-56.25, -0.7003838029733238)', '(-56.25, -10.505756145243598)', '(-56.25, -11.906523334953757)', '(-56.25, -13.307290410446194)', '(-56.25, -14.708057356404804)', '(-56.25, -16.108824156841283)', '(-56.25, -17.509590794998555)', '(-56.25, -18.91035725324536)', '(-56.25, -2.1011514025789793)', '(-56.25, -20.311123512960364)', '(-56.25, -21.711889554404237)', '(-56.25, -3.501918983131298)', '(-56.25, -30.116479933546326)', '(-56.25, -4.902686531826539)', '(-56.25, -6.303454035707604)', '(-56.25, -7.704221481600492)', '(-56.25, -9.104988856048523)', '(-56.25, 0.7003838029733238)', '(-57.65625, -0.7003838029733238)', '(-57.65625, -10.505756145243598)', '(-57.65625, -11.906523334953757)', '(-57.65625, -13.307290410446194)', '(-57.65625, -14.708057356404804)', '(-57.65625, -16.108824156841283)', '(-57.65625, -17.509590794998555)', '(-57.65625, -18.91035725324536)', '(-57.65625, -2.1011514025789793)', '(-57.65625, -20.311123512960364)', '(-57.65625, -21.711889554404237)', '(-57.65625, -3.501918983131298)', '(-57.65625, -4.902686531826539)', '(-57.65625, -6.303454035707604)', '(-57.65625, -7.704221481600492)', '(-57.65625, -9.104988856048523)', '(-57.65625, 0.7003838029733238)', '(-59.0625, -0.7003838029733238)', '(-59.0625, -10.505756145243598)', '(-59.0625, -11.906523334953757)', '(-59.0625, -13.307290410446194)', '(-59.0625, -14.708057356404804)', '(-59.0625, -16.108824156841283)', '(-59.0625, -2.1011514025789793)', '(-59.0625, -3.501918983131298)', '(-59.0625, -4.902686531826539)', '(-59.0625, -6.303454035707604)', '(-59.0625, -7.704221481600492)', '(-59.0625, -9.104988856048523)', '(-59.0625, 0.7003838029733238)', '(-60.46875, -0.7003838029733238)', '(-60.46875, -10.505756145243598)', '(-60.46875, -11.906523334953757)', '(-60.46875, -13.307290410446194)', '(-60.46875, -2.1011514025789793)', '(-60.46875, -3.501918983131298)', '(-60.46875, -4.902686531826539)', '(-60.46875, -6.303454035707604)', '(-60.46875, -7.704221481600492)', '(-60.46875, -9.104988856048523)', '(-60.46875, 0.7003838029733238)', '(-60.46875, 2.1011514025789793)', '(-60.46875, 3.501918983131298)', '(-60.46875, 4.902686531826539)', '(-61.875, -0.7003838029733238)', '(-61.875, -10.505756145243598)', '(-61.875, -11.906523334953757)', '(-61.875, -13.307290410446194)', '(-61.875, -2.1011514025789793)', '(-61.875, -3.501918983131298)', '(-61.875, -4.902686531826539)', '(-61.875, -6.303454035707604)', '(-61.875, -7.704221481600492)', '(-61.875, -9.104988856048523)', '(-61.875, 0.7003838029733238)', '(-61.875, 2.1011514025789793)', '(-61.875, 3.501918983131298)', '(-63.28125, -0.7003838029733238)', '(-63.28125, -10.505756145243598)', '(-63.28125, -11.906523334953757)', '(-63.28125, -2.1011514025789793)', '(-63.28125, -3.501918983131298)', '(-63.28125, -4.902686531826539)', '(-63.28125, -6.303454035707604)', '(-63.28125, -7.704221481600492)', '(-63.28125, -9.104988856048523)', '(-63.28125, 0.7003838029733238)', '(-63.28125, 2.1011514025789793)', '(-63.28125, 3.501918983131298)', '(-64.6875, -0.7003838029733238)', '(-64.6875, -10.505756145243598)', '(-64.6875, -11.906523334953757)', '(-64.6875, -2.1011514025789793)', '(-64.6875, -3.501918983131298)', '(-64.6875, -4.902686531826539)', '(-64.6875, -6.303454035707604)', '(-64.6875, -7.704221481600492)', '(-64.6875, -9.104988856048523)', '(-64.6875, 0.7003838029733238)', '(-66.09375, -0.7003838029733238)', '(-66.09375, -2.1011514025789793)', '(-66.09375, -3.501918983131298)', '(-66.09375, -4.902686531826539)', '(-66.09375, -6.303454035707604)', '(-66.09375, -7.704221481600492)', '(-66.09375, -9.104988856048523)', '(-66.09375, 0.7003838029733238)', '(-67.5, -0.7003838029733238)', '(-67.5, -2.1011514025789793)', '(-67.5, -3.501918983131298)', '(-67.5, -4.902686531826539)', '(-67.5, -6.303454035707604)', '(-67.5, -7.704221481600492)', '(-67.5, -9.104988856048523)', '(-67.5, 0.7003838029733238)', '(-67.5, 2.1011514025789793)', '(-68.90625, -0.7003838029733238)', '(-68.90625, -10.505756145243598)', '(-68.90625, -2.1011514025789793)', '(-68.90625, -3.501918983131298)', '(-68.90625, -4.902686531826539)', '(-68.90625, -6.303454035707604)', '(-68.90625, -7.704221481600492)', '(-68.90625, -9.104988856048523)', '(-68.90625, 0.7003838029733238)', '(-70.3125, -10.505756145243598)', '(-70.3125, -4.902686531826539)', '(-70.3125, -6.303454035707604)', '(-70.3125, -7.704221481600492)', '(-70.3125, -9.104988856048523)', '(-71.71875, -4.902686531826539)', '(-71.71875, -6.303454035707604)', '(-71.71875, -7.704221481600492)', '(-71.71875, -9.104988856048523)', '(-73.125, -7.704221481600492)']

# Coordinates
lon_value = -36.5625
lat_value = -7.704221481600492
month_value = 12  # December
# Access the data for December at the specified coordinates
a = ds['a'].sel(lon=lon_value, lat=lat_value, time=month_value).item()
b = ds['b'].sel(lon=lon_value, lat=lat_value, time=month_value).item()
#Or access the data for December at the nearest point
lon_value = -36.9
lat_value = -7.9
month_value = 12  # December
# Access the data for December at the specified coordinates
a_nearest = ds['a'].sel(lon=lon_value, lat=lat_value, time=month_value,method = 'nearest').item()
b_nearest = ds['b'].sel(lon=lon_value, lat=lat_value, time=month_value, method = 'nearest').item()

#typical code to access corrected forcasted data, with interpolation
# Step 1: Open the NetCDF file
ds = xr.open_dataset('ssp_corr/ssp_corr_585.nc')

# Step 2: Define the specific time and location
time = '1/31/2015' # should be last day of a month, available years are ranging from 2015 to 2100 included
time = pd.to_datetime(specific_time, format='%m/%d/%Y')
lon = -36.5625 # Replace with your desired longitude
lat = -8 # Replace with your desired latitude

# Step 3: Apply bilinear interpolation to extract data for the specific time and location
prec_value = ds['prec'].interp(time=time, lon=lon, lat=lat).values
corr_prec_value = ds['corr_prec'].interp(time=time, lon=lon, lat=lat).values

# Step 4: Print the extracted values
print(f"Precipitation on {time} at (lon={lon}, lat={lat}): {prec_value}")
print(f"Corrected Precipitation on {time} at (lon={lon}, lat={lat}): {corr_prec_value}")

